<%
def largest_hash_key(hash)
  hash.max_by{|k,v| v}
end

def smallest_hash_key(hash)
  hash.min_by{|k,v| v}
end
%>


<div class="dashboard-item">
  <h2><%= name -%></h2>
  <div class="gauge-wrapper">

      <div class="range">
        <div class="range-lower" style="--degrees: <%= (smallest_hash_key(submissions)[1] * 18) - 90 - 5 %>deg;"></div> <!-- lowest.score -->
        <div class="range-upper" style="--degrees: <%= (largest_hash_key(submissions)[1] * 18) - 90 + 5 %>deg;"></div> <!-- highest.score -->
      </div>

      <div class="cutout"></div>
      <div class="range-background"></div>
      <div class="center-dot"></div>

      <% average_score = 0 %>
      <% submissions.each do |(id, score)| %>
        <% average_score += score %>
      <% end %>
      <% average_score = average_score/submissions.length %>
      <div class="gauge-indicator survey_1" style="--degrees: <%= (average_score.round(2) * 18) - 90 %>deg;"></div>

    <div class="circle"></div>
  </div>
  <div class="text-circle">
    <%= (average_score.round(2) * 10).round %><sup>%</sup>
  </div>
  <div>
    <% pp submissions -%>
  </div>
</div>
